<!DOCTYPE html>
<head>
    <title>gravitypong</title>

    <script src="https://cdn.jsdelivr.net/npm/p5@1.9.0/lib/p5.js"></script>
    <script type="module" src="./dist/index.js"></script>

    <script>
        let s = null;

        function initSim() {
            if (!s) {
                const Simulation = window["Simulation"];
                const DynamicBody = window["DynamicBody"];
                const Vec2 = window["Vec2"];

                console.log(Simulation);
                console.log(window["test"]);

                if (Simulation) {
                    s = Simulation.getInstance();
                                
                    s.addBody(new DynamicBody(100000, 30, new Vec2(300, 300)));
                    s.addBody(new DynamicBody(100, 5, new Vec2(100, 250)));
                    s.addBody(new DynamicBody(10000, 15, new Vec2(30, 100)));
                    s.addBody(new DynamicBody(500, 7, new Vec2(100, 500)));
                    s.addBody(new DynamicBody(500, 7, new Vec2(300, 250)));
                    
                    console.log(s);
                    s.start();
                }
            } 
        }



        function setup() {
            frameRate(30);
            createCanvas(640, 640);
        }        
        
        function draw() {
            background(255);
            const c = color(65);

            initSim();

            fill(c);
            if (s && s.bodies) {
                for (const b of s.bodies) {
                    circle(b.pos.x, b.pos.y, b.radius);
                }
            } else {
                s = window["sim"]
                console.log(s)
            }
        }
    </script>
</head>
<body>
    <h3>Hello, Wordl</h3>
    <div id="p5sketch"></div>
</body>