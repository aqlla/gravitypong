<!DOCTYPE html>
<head>
    <title>gravitypong</title>

    <script src="https://cdn.jsdelivr.net/npm/p5@1.9.0/lib/p5.js"></script>
    <script type="module" src="./dist/index.js"></script>

    <script>
        let s = null;

        function initSim() {
            if (!s) {
                const Simulation = window["Simulation"];
                const DynamicBody = window["DynamicBody"];
                const Vec2 = window["Vec2"];

                console.log(Simulation);
                console.log(window["test"]);

                if (Simulation) {
                    s = Simulation.getInstance(500);
                    s.start();
                }
            } 
        }

        function setup() {
            frameRate(20);
            createCanvas(1000, 1000);
        }        
        
        function draw() {
            background(200);
            const c = color(65);

            initSim();

            fill(c);
            if (s && s.bodies) {
                for (const b of s.bodies.values()) {
                    circle(b.pos.x + 500, b.pos.y + 500, b.r);
                }
            } else {
                s = window["sim"]
                console.log(s)
            }
        }
    </script>
</head>
<body>
    <h3>Sim</h3>
    <div id="controls">

    </div>
    <div id="p5sketch"></div>
</body>